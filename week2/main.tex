\documentclass{beamer}

% \usepackage[utf8]{inputenc}
% \usepackage[T1]{fontenc}
\usepackage{lmodern}   % modern Latin Modern fonts
\usepackage{textcomp}  % provides \textquoteright
\usepackage{lmodern} % Latin Modern fonts with T1 shapes


\usepackage{graphicx}
\usepackage{ragged2e} % for generating dummy text
\usepackage[backend=biber,style=authoryear]{biblatex}
% \addbibresource{references.bib}

\usetheme{Madrid}
\usecolortheme{default}
\usefonttheme{professionalfonts} % keeps proper math fonts

\usepackage{amsmath,amssymb,amsfonts} % math symbols (\mathcal, \mathbb, etc.)
\usepackage{mathrsfs}                 % optional: \mathscr for fancy script

% \setbeamercovered{invisible} 
\setbeamercovered{transparent}



% \title{MF921 Topics in Dynamic Asset Pricing}
% \author{Stochastic Analysis \& Stochastic Calculus in Quantitative Finance}
% %\institute{Boston University}
% \date{Yuanhui Zhao\\Week 2\\Boston University}
\title{MF921 Topics in Dynamic Asset Pricing}
\subtitle{Stochastic Analysis \& Stochastic Calculus in Quantitative Finance}
\author{Yuanhui Zhao}
\date{Boston University\\Week 2}

\begin{document}
\frame{\titlepage}
% \begin{frame}
% \frametitle{Outline}
% \tableofcontents
% \end{frame}
\section{Change of Numeraire}
\begin{frame}{Change of Numeraire: Motivation and Key Idea}
    \par In option pricing, we usually price under the risk-neutral measure using 
    the money market account $B(t) = e^{rt}$ as the numeraire. 
    But sometimes payoffs become simpler if we change the unit of measurement (the numeraire).
    Instead of measuring in “dollars,” measure in “shares of stock”.
    \vspace{1em}
    \par The key idea is :
    \begin{itemize}
        \item Pick any strictly positive traded asset $N(t)$ as the numeraire.
        \item Then define a new probability measure $\tilde{\mathbb{P}}$ such that 
        $\frac{S(t)}{N(t)} \quad \text{is a martingale under } \tilde{\mathbb{P}}.$ No-arbitrage is preserved.
    \end{itemize}
    \vspace{1em}
    \par We first look at the details how this work (Radon Nikodym derivative \& Girsanov Theorem) and 
    then apply the scheme to price different type of options. 
\end{frame}
\begin{frame}{Change of Numeraire}
    \par Given $(\Omega, \mathcal{F}, (\mathcal{F}_t)_{t \geq 0}, \mathbb{P}^*)$ with $d$-dim Brownian $W$:
    \vspace{1em}
    \begin{itemize}
        \item Money market account (baseline numeraire): $ dB_t =  B_t r_t dt$
        \item Traded asset $S(t)$: $dS_t = S_t(r_t dt + \sigma_t\, dW_t),
    \quad \tfrac{S_t}{B_t} \text{ is a martingale.}$
        \item Derivative pricing rule: for payoff $X_T$ at maturity $T$, $V_0 = \mathbb{E}^{\mathbb{P}^*}\left[\frac{X_T}{B_T}\right]$
    \end{itemize}
    \vspace{1em}
    \par Our goal is to pick another strictly positive traded asset $N(t)$ and
  define a new measure $\tilde{\mathbb{P}}$ such that $\frac{S(t)}{N(t)}$ is a martingale for every traded asset $S(t)$.
\end{frame}
\begin{frame}{Change of Numeraire Con.}

    {\footnotesize \footnotesize
    \par Oberve $\displaystyle \frac{S(t)}{B(t)}$ is a martingale under $\mathbb{P}^*$. 
    We want $\displaystyle \frac{S(t)}{N(t)}$ to be a martingale under $\tilde{\mathbb{P}}$.
    \par Define $\tilde{\mathbb{P}}$ via the Radon$-$Nikodym derivative with respect to $\mathbb{P}^*$:
    \begin{align*}
        \left.\frac{d\tilde{\mathbb{P}}}{d\mathbb{P}^*}\right|_{\mathcal{F}_T} = Z_T : = \;\;\frac{N(T)/B(T)}{N(0)/B(0)}
    \end{align*}
    \par By construction, $\frac{N(T)}{B(T)}$ is a martingale under $\mathbb{P}^*$, $Z_T >0$ and $\mathbb{E}^{\mathbb{P}^*}[Z_T]=1$ and take any payoff $X_T$:
    \begin{align*}
         V(0) \;=\; N(0)\,\mathbb{E}^{\tilde{\mathbb{P}}}\!\left[\frac{X_T}{N(T)}\right] 
         =N(0) \mathbb{E}^{\mathbb{P}^*}\!\left[\frac{X_T}{N(T)}\,Z_T\right] = \mathbb{E}^{\mathbb{P}^*}\!\left[\frac{X_T}{B(T)}\right]
    \end{align*}
    \vspace{0.5em}
    \par So the choice of Radon$-$Nikodym derivative guarantees the prices are consistent under both measures and no arbitrage is preserved.
    }
    
\end{frame}
\begin{frame}{Change of Numeraire Con.}

    {\footnotesize \footnotesize
    \par What is the $dS(t)$ looks like under meausre $\tilde{\mathbb{P}}?$
    \par Note: Under $Q$, we have $\begin{cases}
        dS(t) = r(t) S(t) \,dt + \sigma(t) S(t) \,dW(t)\\dN(t) = r(t) N(t) \,dt + \gamma(t) N(t) \,dW(t)
    \end{cases}$
    \par Denote $\widehat N_t = \frac{N_t}{B_t}$, apply Itô we get
     $\frac{d\widehat N_t}{\widehat N_t}=\gamma_t\,dW_t$, $\widehat N_t
    = \widehat N_0 e^{\left(
      \int_0^t \gamma_s \cdot dW_s
      - \frac{1}{2} \int_0^t \|\gamma_s\|^2 \, ds
    \right)}.$
    \par Oberve that $Z_t  = \frac{\widehat N_t}{\widehat N_0} = e^{\left(
      \int_0^t \gamma_s \cdot dW_s
      - \frac{1}{2} \int_0^t \|\gamma_s\|^2 \, ds
    \right)}$
    \par Girsanov's theorem says: if we define a new measure $\tilde{\mathbb{P}}$ via this $Z_t$, then the process
            \[
        \tilde{W}(t) \;=\; W(t) - \int_{0}^{t}\gamma_sdt
            \]
        is a Brownian motion under $\tilde{\mathbb{P}}$. Substitute into $dS(t)$ to get the $\tilde{\mathbb{P}}$ dynamics:
        \begin{align*}
            dS(t) = S(t)\Big[ (r(t) + \sigma(t) \cdot \gamma(t))\,dt + \sigma(t)  \cdot d\tilde{W}(t) \Big]
        \end{align*}
        \begin{align*}
            S(t)
           = S_0 \exp\!\left(
            \int_0^t \!\Big(r(s) + \sigma(s) \!\cdot\!\gamma(s) - \tfrac12 \|\sigma(s)\|^2\Big) ds
            + \int_0^t \!\sigma(s) \!\cdot\! d\tilde{W}(s)\right)
        \end{align*}
    }
    
\end{frame}
\section{Black-Scholes Formula}
\begin{frame}{Black-Scholes Formula}


    {\footnotesize \footnotesize
    \par Given $r, \sigma$ are constant, we have $S(T) = S(0) \exp\left\{(r - \tfrac{1}{2} \sigma^2) T + \sigma W(T)\right\}$.
    \vspace{1em}
    \par The no-arbitrage price for the call option:
    \begin{align*}
        \psi_c(0)& = \mathbb{E}^{\mathbb{P}^*}(e^{-rT}(S(T) - K)^+)\\&= \mathbb{E}^{\mathbb{P}^*}(e^{-rT}(S(T) - K)I(S(T) \geq K)) \\
        &= \mathbb{E}^{\mathbb{P}^*}(e^{-rT}S(T)I(S(T) \geq K)) - Ke^{-rT}\mathbb{P}^*(S(T) \geq K)\\& = I - Ke^{-rT} \cdot II \
    \end{align*}
    \par For $II$:
    \begin{align*}
        II = \mathbb{P}^*(S(T) \geq K) &= 1 - \Phi \left( \frac{\log(K/S(0)) - (r - \frac{1}{2}\sigma^2)T}{\sigma\sqrt{T}} \right) \\
        &= \Phi \left( \frac{\log(S(0)/K) + (r - \frac{1}{2}\sigma^2)T}{\sigma\sqrt{T}} \right)
    \end{align*}
    \par Note: $\Phi$ is the CDF of the standard normal distribution.
    }
\end{frame}
\begin{frame}{Black-Scholes Formula Con.}

    {\footnotesize \footnotesize
    \par For $I$, we apply the change of numeraire and use stock itself as numeraire. Then based on the eraly definition
    we have $\left.\frac{d\tilde{\mathbb{P}}}{d\mathbb{P}^*}\right|_{\mathcal{F}_T} = Z_T :=  e^{-rT}\frac{S(T)}{S(0)}$
    and $\gamma_t = \sigma$. Therefore, under \(\tilde{\mathbb{P}}\) we have the following dynamics of \(S(t)\):
    \[
    \frac{dS_t}{S_t} = rdt + \sigma^2 dt + \sigma \tilde{dW_t},\;
    S(t) = S(0) \exp \left\{ (r + \sigma^2/2) t + \sigma \tilde{W_t} \right\}
    \]
    \par Then we can rewrite $I$:
    \begin{align*}
        I = S(0)\mathbb{E}^{\mathbb{P}^*} \left( e^{-rT} \frac{S(T)}{S(0)} I(S(T) \geq K) \right) &= S(0) \mathbb{E}^{\tilde{\mathbb{P}}} (I(S(T) \geq K)) \\
        &= S(0) \tilde{\mathbb{P}}(S(T) \geq K)\\
       & = S(0) \Phi \left( \frac{\log(S(0)/K) + (r + \frac{1}{2} \sigma^2) T}{\sigma \sqrt{T}} \right).
    \end{align*}
   \par Putting together, we have the price of the call option is given by:
    \[
    I - Ke^{-rT} \cdot II = S(0) \Phi(d_+) - Ke^{-rT} \Phi(d_-)
    \]
where $d_{\pm} = \frac{\log(S(0)/K) + (r \pm \frac{1}{2} \sigma^2) T}{\sigma \sqrt{T}}.$

    }
\end{frame}

\section{One Dimensional Barrier Options}
\begin{frame}{One Dimensional Barrier Options}

    {\footnotesize \footnotesize
    \par Barrier options are path-dependent derivatives whose payoff is activated (knock-in) or extinguished (knock-out) 
    if the underlying asset crosses a pre-specified barrier. They extend vanilla 
    calls/puts by adding a barrier condition.
    \par We first study continuously monitored barriers and derive 
    Merton's closed-form pricing formulas (1973) for single-barrier options.
    \par Given $(\Omega, \mathcal{F}, (\mathcal{F}_t)_{t \geq 0}, \mathbb{P}^*)$ with 1-dim Brownian $W$. 
    The Market setting following:
    \begin{align*}
        dB(t) =  B(t) r dt\;,\;dS(t) = r S(t)  dt + \sigma S(t)  dW(t)
    \end{align*}
    % \begin{center}
    %     $\begin{cases}
    %     dB_t =  B_t r dt\\ 
    % \end{cases}$
    % \end{center}
    \par A continuously monitored barrier option has 
    payoff = vanilla option payoff \(\times\) indicator of the barrier condition. For example: 
    \begin{itemize}
        \item Up-and-out call: $V_0 = \mathbb{E}^{\mathbb{P}^*} \left[ e^{-rT} (S(T) - K)^+ I{\left\{ \max\limits_{0 \leq t \leq T} S(t) \leq H \right\}} \right], \quad H > S(0)$
        \item Down-and-in put: $ V_0 = \mathbb{E}^{\mathbb{P}^*} \left[ e^{-rT} (K - S(T))^+ I{\left\{ \min\limits_{0 \leq t \leq T} S(t) \leq H \right\}} \right], \quad H < S(0)$
    \end{itemize}
     \par Study the case of the down-and-in call option (DAIC) with strike \( K \), barrier \( H < S(0) \):
    \begin{align*}
        \text{DAIC} = e^{-rT}  \mathbb{E}^{\mathbb{P}^* }
        \left[ (S(T) - K)^+ I{\left\{\min\limits_{0 \leq t \leq T} S(t) \leq H \right\}} \right] 
    \end{align*}
    }
    
\end{frame}
\begin{frame}{One Dimensional Barrier Options Con.}
    
    {\footnotesize \footnotesize
    \par For notation simplicity, denote a drifted Brownian motion:
          \[
          W_{\mu,\sigma}(t) = \mu t + \sigma W(t), \quad M_t = \max_{0 \leq s \leq t} W_{\mu,\sigma}(s).
          \]
    \par Some useful results from the reflection principle for a Brownian motion with a  drift:
    \par (i) When \( x \leq y \), $y > 0,  \sigma > 0$ :
    \begin{itemize}
         {\footnotesize \scriptsize
        \item $P(W_{\mu, \sigma}(t) \leq x,  M_t \geq y) = e^{2\mu y / \sigma^2} 
        \Phi \left( \frac{x - 2y - \mu t}{\sigma \sqrt{t}} \right)$
        \item $P(W_{\mu, \sigma}(t) \leq x,  M_t \leq y) = \Phi \left( \frac{x - \mu t}{\sigma \sqrt{t}} \right) - e^{2\mu y / \sigma^2} 
         \Phi \left( \frac{x - 2y - \mu t}{\sigma \sqrt{t}} \right)$
         }
    \end{itemize}
    \par (ii) When \( x \geq y>0 \), $\sigma > 0$:
    \begin{itemize}
         {\footnotesize \scriptsize
        \item $P(W_{\mu, \sigma}(t) \leq x,  M_t \leq y) = P(M_t \leq y) \nonumber =
            \Phi \left( \frac{y - \mu t}{\sigma \sqrt{t}} \right) - e^{2\mu y / \sigma^2} \Phi 
            \left( \frac{-y - \mu t}{\sigma \sqrt{t}} \right)$
        \item $P(W_{\mu, \sigma}(t) \leq x,  M_t \geq y) = P(W_{\mu, \sigma}(t) \leq x) - P(W_{\mu, \sigma}(t) \leq x,  M_t \leq y) \nonumber 
            = \Phi \left( \frac{x - \mu t}{\sigma \sqrt{t}} \right) - 
            \Phi \left( \frac{y - \mu t}{\sigma \sqrt{t}} \right) + e^{2\mu y / \sigma^2} \Phi \left( \frac{-y - \mu t}{\sigma \sqrt{t}} \right)$
         }
    \end{itemize}
    \par (iii) When \( x \geq y \), $y < 0$, $\sigma > 0$:
    \begin{itemize}{\footnotesize \scriptsize
        \item $P\left( W_{\mu, \sigma}(t) \geq x, \min\limits_{0 \leq s \leq t} W_{\mu, \sigma}(s) \leq y \right) 
        = e^{2\mu y / \sigma^2} \Phi \left( \frac{-x + 2y + \mu t}{\sigma \sqrt{t}} \right)$
        }
    \end{itemize}
    }
\end{frame}
\begin{frame}{One Dimensional Barrier Options Con.}

    {\footnotesize \scriptsize
    \par Back to the valuation of DAIC:
    {\footnotesize \scriptsize
    \begin{align*}
    &\mathbb{E}^{\mathbb{P}^*}\left[e^{-rT}(S(T) - K)^+ I\left(\min_{0 \leq t \leq T} S(t) \leq H\right)\right]\\
    &= \mathbb{E}^{\mathbb{P}^*}\left[e^{-rT}(S(T) - K)I\left(S(T) \geq K, \min_{0 \leq t \leq T} S(t) \leq H\right)\right] \\
    &= \mathbb{E}^{\mathbb{P}^*}\left[e^{-rT}S(T)I\left(S(T) \geq K, \min_{0 \leq t \leq T} S(t) \leq H\right)\right] \\
    &\quad - Ke^{-rT}P^*\left(S(T) \geq K, \min_{0 \leq t \leq T} S(t) \leq H\right) \\
    &= I - Ke^{-rT} \cdot II 
    \vspace{-0.5em}
    \end{align*}
    \par For II:
    \vspace{-0.5em}
    \begin{align*}
    II &= P^*\left(S(T) \geq K, \min_{0 \leq t \leq T} S(t) \leq H\right) \\
    &= P\left\{W_{r-\frac{\sigma^2}{2},\sigma}(T) \geq \log(K/S(0)), \min_{0 \leq t \leq T} W_{r-\frac{\sigma^2}{2},\sigma}(t) \leq \log(H/S(0))\right\} \\
    &= \exp\left\{\frac{2(r - \sigma^2/2)}{\sigma^2} \log(H/S(0))\right\} 
     \cdot \Phi \left(\frac{2 \log(H/S(0)) - \log(K/S(0)) + (r - \sigma^2/2)T}{\sigma \sqrt{T}}\right)\\
     &=(H/S(0))^{\frac{2r}{\sigma^2}-1} \Phi \left(\frac{\log(\{H^2/S(0)\}/K) 
     + (r - \sigma^2/2)T}{\sigma \sqrt{T}}\right)\\
    \end{align*}

    }
    }
\end{frame}
\begin{frame}{One Dimensional Barrier Options Con.}
    
    {\footnotesize \footnotesize
    \par For I, by changing of numeraire we can get:
    \vspace{-0.5em}
    {\footnotesize \scriptsize
    \begin{align*}
    I &= S(0) \mathbb{E}^{\mathbb{P}^*} \left( e^{-rT} \frac{S(T)}{S(0)} \cdot I\left\{S(T) \geq K, \min_{0 \leq t \leq T} S(t) \leq H\right\} \right) \\
    &= S(0) \tilde{P}\left(S(T) \geq K, \min_{0 \leq t \leq T} S(t) \leq H\right) \\
    &= S(0) P\left\{W_{r+\frac{\sigma^2}{2}, \sigma}(T) \geq \log(K/S(0)), \min_{0 \leq t \leq T} W_{r+\frac{\sigma^2}{2}, \sigma}(t) \leq \log(H/S(0))\right\} \\
    &= S(0) \cdot (H/S(0))^{\frac{2r}{\sigma^2}+1} \Phi \left( \frac{\log(\{H^2/S(0)\}/K)+(r+\sigma^2/2)T}{\sigma\sqrt{T}} \right) \\
    &= (H/S(0))^{\frac{2r}{\sigma^2}-1}(H^2/S(0)) \Phi \left( \frac{\log(\{H^2/S(0)\}/K)+(r+\sigma^2/2)T}{\sigma\sqrt{T}} \right)
    \end{align*}
    \par Putting the two terms together, we get $I - Ke^{-rT} \cdot II = (H/S(0))^{\frac{2r}{\sigma^2}-1} \text{BSC}(H^2/S(0))$. 
    Where \(\text{BSC}(x)\) is the Black-Scholes formula for a call option with the initial stock price being \(x\):
    \begin{align*}
        \text{BSC}(x) = x\Phi(d_+) - Ke^{-rT}\Phi(d_-) \text{ with } d_{\pm} = \frac{\log(x/K)+(r\pm\sigma^2/2)T}{\sigma\sqrt{T}}
    \end{align*}
    \vspace{-1em}
    }
    }
\end{frame}
\section{Exchange Options}
\begin{frame}{Exchange Options}

    {\footnotesize \footnotesize
    \par Given $(\Omega, \mathcal{F}, (\mathcal{F}_t)_{t \geq 0}, \mathbb{P}^*)$ 
    with 2-dim independent Brownian, \( W_1(t) \) and \( W_2(t) \). 
    We have two traded assets \( S_1(t) \) and \( S_2(t) \) with the following dynamics:
    \begin{align*}
    \frac{dS_1(t)}{S_1(t)} &= rdt + \sigma_1 dW_1(t) \\
    \frac{dS_2(t)}{S_2(t)} &= rdt + \sigma_2 \left\{ \rho dW_1(t) + \sqrt{1 - \rho^2} dW_2(t) \right\}
    \end{align*}
    \par The exchange option gives the holder the right, but not the obligation, 
    to exchange asset \(S_2\) for asset \(S_1\) at maturity \(T\). The price of this option as following:
    \begin{align*}
        u(0) &= \mathbb{E}^{\mathbb{P}^*}\left[e^{-rT}(S_1(T) - S_2(T))^+\right]\\
        &=S_2(0) \mathbb{E}^{\mathbb{P}^*}\left[ \frac{e^{-rT} S_2(T)}{S_2(0)} \left( \frac{S_1(T)}{S_2(T)} - 1 \right)^+ \right] \\
        &= S_2(0) \mathbb{E}^{\tilde{\mathbb{P}}} \left[ \left( \frac{S_1(T)}{S_2(T)} - 1 \right)^+ \right] \\
        &= S_2(0) \mathbb{E}^{\tilde{\mathbb{P}}} \left[ (F(T) - 1)^+ \right]
    \end{align*}

    }
\end{frame}
\begin{frame}{Exchange Options Con.}

    {\footnotesize \footnotesize
    \par Apply Itô, we have the Radon$-$Nikodym derivative for numeraire:
    \begin{align*}
        Z_T := \frac{e^{-rT} S_2(T)}{S_2(0)} = \exp \left[ \sigma_2 
        \left\{ \rho W_1(T) + \sqrt{1 - \rho^2} W_2(T) \right\} - \frac{T}{2} \sigma_2^2 \right]
    \end{align*}
    \par By Girsanov theorem, under new measure $\tilde{\mathbb{P}}$:
    \begin{align*}
        \tilde{W}_1(t) &= W_1(t) - \rho\sigma_2 t, \;\; \tilde{W}_2(t) = W_2(t) - \sigma_2\sqrt{1-\rho^2} t
    \end{align*}
    \par Apply Itô, we can get $d\ln S_1$, $d\ln S_2$:
    \begin{align*}
        d \ln F(t) &= d \ln S_1(t) - d \ln S_2(t) \\
        &= \left[  - \tfrac{1}{2}\sigma_1^2  - \tfrac{1}{2}\sigma_2^2 + \rho \sigma_1 \sigma_2 \right] dt 
        + (\sigma_1 - \rho \sigma_2) d\tilde{W}_1 - \sigma_2 \sqrt{1-\rho^2} d\tilde{W}ß¢_2.
    \end{align*}
    \par Apply Itô to $g(x) = e^x$ with $x = \ln F(t)$:
    \begin{align*}
        \frac{dF_t}{F_t} = d(\ln F_t) + \frac{1}{2} d<\ln F>_t 
        = (\sigma_1 - \rho\sigma_2) d\tilde{W}_{1t} - \sigma_2 \sqrt{1 - \rho^2} d\tilde{W}_{2t}
    \end{align*}
    }
\end{frame}
\begin{frame}{Exchange Options Con.}
    
    {\footnotesize \footnotesize
    \par Denote $\sigma  = \sqrt{\sigma_1^2 - 2\rho\sigma_1\sigma_2 + \sigma_2^2}$, $\tilde{W}(t) := \frac{1}{\sigma} \left\{ (\sigma_1 - \rho\sigma_2)\tilde{W}_1(t) - \sigma_2\sqrt{1 - \rho^2}\tilde{W}_2(t) \right\}$
    Observe that $\tilde{W}$ is a standard Brownian motion under $\tilde{\mathbb{P}}$. 
    We have $\frac{dF(t)}{F(t)} = \sigma d\tilde{W}(t)$, observe that $F_T = F_0 \exp \left( - \frac{1}{2} \sigma^2 T 
    + \sigma \sqrt{T} Z \right),  Z \sim N(0, 1)$.
    % and \(\ln F_T \sim N(\ln F_0 - \frac{1}{2} \sigma^2 T, \sigma^2 T)\).
     \par Then we can rewrite $u(0)$:
     \begin{align*}
        u(0) &= S_2(0) \mathbb{E}^{\tilde{\mathbb{P}}} \left[ (F(T) - 1)^+ \right]\\
        &= S_2(0) \mathbb{E}^{\tilde{\mathbb{P}}} \left[ (F(T) - 1)I(F(T)>1) \right]\\
        &=S_2(0) \left[ \mathbb{E}^{\tilde{\mathbb{P}}}[F_T I{\{F_T > 1\}}] - \tilde{\mathbb{P}}(F_T > 1)\right] \\
     \end{align*}
    }

\end{frame}

% {\mathbb{P}^*}
% \tilde{\mathbb{P}}
% {\footnotesize \footnotesize
% }
% \tiny
% \scriptsize
% \footnotesize
% \small
% \normalsize (default)
% \large
% \Large
% \LARGE
% \huge
% \Huge
\end{document}