\documentclass{beamer}

% \usepackage[utf8]{inputenc}
% \usepackage[T1]{fontenc}
\usepackage{lmodern}   % modern Latin Modern fonts
\usepackage{textcomp}  % provides \textquoteright
\usepackage{lmodern} % Latin Modern fonts with T1 shapes


\usepackage{graphicx}
\usepackage{ragged2e} % for generating dummy text
\usepackage[backend=biber,style=authoryear]{biblatex}
% \addbibresource{references.bib}

\usetheme{Madrid}
\usecolortheme{default}
\usefonttheme{professionalfonts} % keeps proper math fonts

\usepackage{amsmath,amssymb,amsfonts} % math symbols (\mathcal, \mathbb, etc.)
\usepackage{mathrsfs}    
\usepackage{multicol}             % optional: \mathscr for fancy script

% \setbeamercovered{invisible} 
\setbeamercovered{transparent}


\title{MF921 Topics in Dynamic Asset Pricing}
\subtitle{Week 9}
\author{Yuanhui Zhao}
\date{Boston University}

\begin{document}
\frame{\titlepage}
% \begin{frame}
% \frametitle{Outline}
% \tableofcontents
% \end{frame}


\begin{frame}{Chapter 9}

    {
    \begin{center}
        Chapter 12 Backward Stochastic Differential Equations
    \end{center}
    }
    
\end{frame}

\begin{frame}{Motivation and Definition}

    {\footnotesize \footnotesize
Consider the following question: Find a random variable \( Y_0 \) and a progressively measurable process \( Z_t \in \mathbb{R}^d \), such that
\[
-dY_t = f(t, Y_t, Z_t)dt - Z_t^T dW_t, \quad Y_T = \xi,
\]

where \( T \) means transpose, \( \xi \) is a constant ($\mathcal{F}_T$ measurable r.v?), 
and \( W_t \) is a standard \( d \)-dimensional Brownian motion. 
This is an example of backward stochastic differential equations (BSDE), 
which can be viewed as a hedging problem to match the final payoff \( Y_T = \xi \) 
by finding the initial price \( Y_0 \) and the hedging strategy \( Z_t \).
\vspace{1em}
\par In addition to the link with option pricing, there are at least four applications.

(1) BSDE is linked to recursive utilities.

(2) BSDE has been used to study continuous-time principle-agent problems, starting from Sannikov (2008, Review of Economic Studies).

(3) There is a link between BSDE and certain classes of semi-linear parabolic PDE's, as an extension of the Feynman-Kac formula.

(4) There is a natural link between BSDE's and stochastic control problems. 
For example, the above BSDE problem can be formulated as a special stochastic control problem such that
\[
\min_{y,Z} E \left[ \left\{ Y_T^{y,Z} - \xi \right\}^2 \right] = 0,
\]
    }
    
\end{frame}
\begin{frame}{Motivation and Definition}

    {\footnotesize \footnotesize
(4) There is a natural link between BSDE's and stochastic control problems. 
For example, the above BSDE problem can be formulated as a special 
stochastic control problem such that
\[
\min_{y,Z} E \left[ \left\{ Y_T^{y,Z} - \xi \right\}^2 \right] = 0,
\]
where \( Y_T^{y,Z} \) is the solution of
\[
-dY_t = f(t, Y_t, Z_t)dt - Z_t^T dW_t, \quad Y_0 = y.
\]

This minimization problem can be solved by using a neural network, 
by learning \( Y_T^{y,Z} \) to match \( \xi \) as close as possible. 
This connection leads to a fast way to 
solve some semi-linear PDE's, especially in the high-dimensional case, by using neural networks.
\vspace{1em}
\par As a comparison, the HJB equation is a continuous analogy of dynamic programming and 
is in general a nonlinear parabolic PDE, which is challenging to solve numerically, 
especially in high dimensions. However, for certain special stochastic control problem, 
the HJB may become a semi-linear parabolic PDE, which 
can be solved by using neural networks via backward stochastic differential equations (BSDEs).
In general, instead of using BSDEs and PDEs, 
one can use iterated procedure to build a neural network to
 solve stochastic control problems.
    }
    
\end{frame}

\begin{frame}{Motivation and Definition}

    {\footnotesize \footnotesize

\par A formal definition of one-dimensional BSDE 
for a given pair \((\xi,f)\) satisfying the regularity conditions.
\par For the pair \((\xi,f)\) we require: 
\begin{itemize}
    \item  (i) \(\xi\in\mathcal{F}_{T}\) is a \(L^{2}\) random variable.
    \item (ii) \(f(\cdot,t,y,z):\Omega\times[0,T]\times\mathbb{R}\times\mathbb{R}^{d}\to \mathbb{R}\), denoted for simplicity as \(f(t,y,z)\), is progressively 
measurable for all \(y\) and \(z\), such that \(E[\int_{0}^{T}f^{2}(t,0,0)dt]<\infty\).
\end{itemize}
\par A solution to the BSDE at the beginning is a pair \((Y,Z)\), 
both progressively measurable, such that \(E[\sup\limits_{0\leq t\leq T}|Y_{t}|^{2}]<\infty\),
 \(E\left[\int_{0}^{T}|Z_{t}|^{2}\,dt\right]<\infty\), and
 \vspace{-1em}
\[
Y_{t}=\xi+\int_{t}^{T}f(s,Y_{s},Z_{s})ds-\int_{t}^{T}Z_{s}^{\top}dW_{s},\quad 0 \leq t \leq T.
\]
\par Here \(\xi\) and \(f\) are called the terminal condition and the driver of the BSDE, respectively.
\par Given \(\xi \in L^2\) and \(f\) satisfying a uniform Lipschitz condition, i.e. there exists a constant \(C_f\) such that  
\[
|f(t,x_1,y_1) - f(t,x_2,y_2)| \leq C_f \left( |x_1 - x_2| + |y_1 - y_2| \right),
\]  
there exists a unique solution \((Y,Z)\) to the BSDE. Unfortunately, the uniform Lipschitz 
condition does not hold in many cases.
    }
    
\end{frame}

\begin{frame}{Linear BSDE}

    {\footnotesize \footnotesize
    First consider a special case \(f = 0\), in which the BSDE becomes  
    \[
    Y_t = \xi - \int_{t}^{T} Z_s^{\top} dW_s, \quad 0 \leq t \leq T. \tag{*}
    \]
    Recall that the martingale representation theorem yields 
    for every \(\mathcal{F}_T\) measurable and square integrable 
    random variable \(\xi\), there exists a unique progressively measurable 
    process \(\beta_t\), \(E\left[\int_0^T |\beta_t|^2 dt\right] < \infty\), such that
\[
\xi = E[\xi] + \int_0^T \beta_s^T dW_s.
\]
We shall prove that the unique solution of the BSDE $(*)$ is given by
\[
Y_t = E[\xi|\mathcal{F}_t], \quad Z_t = \beta_t.
\]
    }
    
\end{frame}

\begin{frame}{Linear BSDE}

    {\footnotesize \footnotesize
     First note that by 
     \begin{align*}
        Y_t &= E[\xi|\mathcal{F}_t]\\
        &= E[\xi] + E\left[\int_0^T \beta_s^T dW_s |\mathcal{F}_t\right]\\
        &= \xi - \int_0^T Z_s^T dW_s + \int_0^t Z_s^T dW_s 
        + E\left[\int_t^T Z_s^T dW_s |\mathcal{F}_t\right]\\
        & = \xi - \int_t^T Z_s^T dW_s + E\left[\int_t^T Z_s^T dW_s |\mathcal{F}_t\right]\\
        &= \xi - \int_t^T Z_s^T dW_s,
     \end{align*}
because \(E\left[\int_t^T Z_s^T dW_s |\mathcal{F}_t\right] = 0\) as the local
 martingale of the
 stochastic integral becomes a martingale, as will be shown in the following problem. 
    }
    
\end{frame}

\begin{frame}{Linear BSDE}

    {\footnotesize \footnotesize
      Prove that the local martingale \(M_t = \int_0^t Z_s^T dW_s\) is actually a martingale.
      \vspace{1em}
      \par We know that \( E \left[ \int_0^T |Z_t|^2  dt \right] < \infty \) 
      and the quadratic variation of \( \int_0^t Z_s^T dW_s \) is \( \int_0^T |Z_t|^2  dt \). 
      Thus, by the Burkholder-Davis-Gundy inequality for the quadratic variation of a martingale, 
      with \( p = 2 \), there exists a positive constant \( C_2 \) such that
          {\footnotesize \tiny
          \[
E \left[ \left( \sup_{0 \leq t \leq T} \left| \int_0^t Z_s^T dW_s \right| \right)^2 \right]
\leq C_p E \left[ \left( \int_0^T |Z_t|^2  dt \right)^{p/2} \right] 
= C_2 E \left[ \int_0^T |Z_t|^2  dt \right] < \infty.
\]
    }

\par Define stopping times \(\tau_n := \inf\{t : \langle M \rangle_t \geq n\} \land T\). 
Each stopped process \(M_t^{\tau_n} := M_{t \land \tau_n}\) is a bounded \(L^2\)-martingale. 
Because of BDG, the family \(\{M_T^{\tau_n}\}_n\) is uniformly integrable. 
Hence we can pass to the limit \(n \to \infty\) in the martingale property:
\[
\mathbb{E}[M_t \mid \mathcal{F}_s] = \lim_{n \to \infty} \mathbb{E}[M_t^{\tau_n} \mid \mathcal{F}_s] = \lim_{n \to \infty} M_s^{\tau_n} = M_s, \quad 0 \leq s \leq t \leq T,
\]
where we used DCT, justified by the UI bound above. 
Therefore \(M\) is a martingale.
    }
    
\end{frame}

\begin{frame}{Linear BSDE}

    {\footnotesize \footnotesize
    To show the uniqueness of the BSDE $(*)$, without using the general theorem of the BSDE based on the uniform Lipschitz condition, consider a solution pair \((Y_t, Z_t)\). Note that when \(t = 0\)
\[
Y_0 = \xi - \int_0^T Z_s^T dW_s,
\]
yielding
\[
Y_0 = E[\xi] - E \left[ \int_0^T Z_s^T dW_s \right] = E[\xi],
\]
again because \(\int_0^T Z_s^T dW_s\) has a martingale property. Furthermore, by $(*)$,
\[
dY_t = Z_t^T dW_t, \quad Y_t = 
Y_0 + \int_0^t Z_s^T dW_s = E[\xi] + \int_0^t Z_s^T dW_s. \tag{**}
\]
Thus,
\[
\xi = Y_t + \int_{t}^{T} Z_s^T dW_s
= E[\xi] + \int_{0}^{t} Z_s^T dW_s + \int_{0}^{T} Z_s^T dW_s
= E[\xi] + \int_{0}^{T} Z_s^T dW_s.
\]
Such \(Z\) must be unique according 
to the martingale representation theorem. Hence \((Y_t, Z_t)\) 
must be unique due to $(**)$.
    }
    
\end{frame}

\begin{frame}{The solution for the linear BSDE via the Girsanov theorem}

    {\footnotesize \footnotesize
    Now we consider BSDE with a linear driver, i.e.,
\[
f(t,y,z)=A_{t}+B_{t}y+C_{t}^{\top}z,
\]
where \(A_{t}\), \(B_{t}\) are one-dimensional progressive measurable 
processes and \(C_{t}\) is a \(d\)-dimensional progressive measurable process, 
such that
\[
E\left[\int_{0}^{T}|A_{t}|^{2}\,dt\right]<\infty,
\]
\par and \(B_{t}\) and \(C_{t}\) are bounded processes. 
We attempt to reduce this case to the case of zero driver, 
via the Girsanov theorem and other transforms.
\vspace{1em}
\par To eliminate the term \(C_{t}^{\top}z\) in the driver, we consider a new probability measure \(Q\), defined as
\[
\frac{dQ}{dP}=\exp\left\{\int_{0}^{T}C_{t}^{\top}dW_{t}-\frac{1}{2}\int_{0}^{T}| C_{t}|^{2}\,dt\right\},
\]
and a new process
\[
\bar{W}_{t}=W_{t}-\int_{0}^{t}C_{s}ds.
\]
    }
    
\end{frame}

\begin{frame}{The solution for the linear BSDE via the Girsanov theorem}

    {\footnotesize \footnotesize
   By Girsanov theorem, \(\bar{W}_{t}\) is a standard Brownian motion under the new measure \(Q\). Note that the Novikov condition is satisfied because
\[
E\left[\exp\left(\frac{1}{2}\int_{0}^{T}|C_{s}|^{2}\,ds\right)\right]<\infty.
\]

Using \(\bar{W}_{t}\), the dynamic of \(Y_{t}\) can be re-written as
\begin{align*}
    -dY_{t} &= (A_{t}+B_{t}Y_{t}+C_{t}^{\top}Z_{t})\,dt-Z_{t}^{\top}dW_{t}\\
    &= (A_{t}+B_{t}Y_{t}+C_{t}^{\top}Z_{t})\,dt-Z_{t}^{\top}(d\bar{W}_{t}+ C_{t}dt)\\
    &= (A_{t}+B_{t}Y_{t})\,dt-Z_{t}^{\top}d\bar{W}_{t}.
\end{align*}
Next, to eliminate the term \(B_{t}y\) in the driver, we consider the discounted version of \(Y\). More precisely, introduce
\[
Y_{D,t}=Y_{t}\exp\left\{\int_{0}^{t}B_{s}ds\right\},\ \ Z_{D,t}=Z_{t}\exp\left\{ \int_{0}^{t}B_{s}ds\right\}.
\]

    }
    
\end{frame}

\begin{frame}{The solution for the linear BSDE via the Girsanov theorem}

    {\footnotesize \footnotesize
    Then by the Ito formula
    \begin{align*}
        dY_{D,t} &= \exp\left\{\int_{0}^{t}B_{s}ds\right\}dY_{t}
        +Y_{t}\exp\left\{\int_ {0}^{t}B_{s}ds\right\}B_{t}dt\\
        &= \exp\left\{\int_{0}^{t}B_{s}ds\right\}\left\{-A_{t}dt
        -B_{t}Y_{t}dt +Z_{t}^{\top}d\bar{W}_{t}+Y_{t}B_{t}dt\right\}\\
        & = -A_{t}\exp\left\{\int_{0}^{t}B_{s}ds\right\}dt+Z_{D,t}^{\top}d \bar{W}_{t},
    \end{align*}
\par with the terminal condition $Y_{D,T}=\xi\exp\left\{\int_{0}^{T}B_{s}ds\right\}.$
\par Finally to eliminate \(A_{t}\), we define
\[
\bar{Y}_{t}=Y_{D,t}+\int_{0}^{t}A_{u}\exp\left\{\int_{0}^{u}B_{s}ds\right\}du.
\]
Then
\[
d\bar{Y}_{t} = dY_{D,t}+A_{t}\exp\left\{\int_{0}^{t}B_{s}ds\right\}dt= Z_{D,t}^{\top}d\bar{W}_{t},
\]

    }
    
\end{frame}

\begin{frame}{The solution for the linear BSDE via the Girsanov theorem}

    {\footnotesize \footnotesize
    with the terminal condition
    \begin{align*}
        \bar{Y}_T &= Y_{D,T} + \int_0^T A_u \exp \left\{ \int_0^u B_s ds \right\} du\\
        &= \xi \exp \left\{ \int_0^T B_s ds \right\} + \int_0^T A_u 
\exp \left\{ \int_0^u B_s ds \right\} du.
    \end{align*}
    Thus, we can apply the previous result 
    $Y_t = E[\xi|\mathcal{F}_t], \;Z_t = \beta_t$ about BSDE with zero driver, we have the unique solution is given by
\[
\bar{Y}_t = E^Q \left[ \xi \exp \left\{ \int_0^T B_s ds \right\} + \int_0^T A_u \exp \left\{ \int_0^u B_s ds \right\} du | \mathcal{F}_t \right],
\]
whence
\begin{align*}
    Y_{D,t} &= \bar{Y}_t - \int_0^t A_u \exp \left\{ \int_0^u B_s ds \right\} du\\
    &= E^Q \left[ \xi \exp \left\{ \int_0^T B_s ds \right\} +
 \int_t^T A_u \exp \left\{ \int_0^u B_s ds \right\} du | \mathcal{F}_t \right].
\end{align*}
    }
    
\end{frame}

\begin{frame}{The solution for the linear BSDE via the Girsanov theorem}

    {\footnotesize \footnotesize
     Thus, the unique solution of the linear BSDE is given by
     \begin{align*}
        Y_t &= Y_{D,t} \exp \left\{ -\int_0^t B_s ds \right\}\\
        &= E^Q \left[ \xi \exp \left\{ \int_t^T B_s ds \right\} 
+ \int_t^T A_u \exp \left\{ \int_t^u B_s ds \right\} du |\mathcal{F}_t \right].
     \end{align*}

    }
    
\end{frame}

    % {\footnotesize \tiny

    % }
% \begin{frame}{}

%     {\footnotesize \footnotesize

%     }
    
% \end{frame}
% % {\mathbb{P}^*}
% \tilde{\mathbb{P}}
% {\footnotesize \footnotesize
% }
% \tiny
% \scriptsize
% \footnotesize
% \small
% \normalsize (default)
\end{document}